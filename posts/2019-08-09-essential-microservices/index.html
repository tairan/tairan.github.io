<!DOCTYPE html>
<html lang="en-us">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">




<title>微服务要素 | Tairan&#39;s Story</title>

<link rel="stylesheet" href="https://tairan.net//css/styles.css">

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.2.0/css/all.css" 
integrity="sha384-hWVjflwFxL6sNzntih27bfxkr27PmbbK/iSvJ+a4+0owXq79v+lsFkW54bOGbiDQ" crossorigin="anonymous">
<script src="https://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>


<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/zenburn.min.css" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js" integrity="sha256-/BfiIkHlHoVihZdc6TFuj7MmJ0TWcWsMXkeDFwhi0zw=" crossorigin="anonymous"></script>
<script>hljs.initHighlightingOnLoad();</script>
<script src="https://tairan.net//js/highlight.js"></script>






<div class="container">
    <nav class="navbar level">
      <div class="navbar-brand">
          <a class="nav-item" href="https://tairan.net/"><h1 class="title is-3">Tairan&#39;s Story</h1></a>
      </div>           
      <div class="navbar-menu has-text-centered is-active">
          <div class="navbar-end is-centered">
              
                <a href="https://tairan.net/about.html" rel="me">
                  <span class="icon">
                    <i class="fas fa-info"></i>
                  </span>
                </a>
              
                <a href="https://github.com/tairan" rel="me">
                  <span class="icon">
                    <i class="fab fa-github"></i>
                  </span>
                </a>
              
                <a href="https://www.linkedin.com/in/tairan/" rel="me">
                  <span class="icon">
                    <i class="fab fa-linkedin-in"></i>
                  </span>
                </a>
              
                <a href="https://twitter.com/tairan" rel="me">
                  <span class="icon">
                    <i class="fab fa-twitter"></i>
                  </span>
                </a>
              
           </div>
      </div>
    </nav>
  </div>

<div class="container">
  <h2 class="subtitle is-6">August 9, 2019</h2>
  <h1 class="subtitle is-size-4-mobile is-size-3-desktop">微服务要素</h1>
  <div class="content">
    

<p>时至今日，微服务已经遍地开花，属于成熟的技术。一个基本合格的微服务应该是这样的：</p>

<h2 id="网关">网关</h2>

<p>如果每个服务是业务担当的话，那么网关则是名副其实的技术担当。作为网关，它承担了诸多重任：</p>

<ul>
<li><p>拒载， 当一些恶意用户或者不符合访问要求的客户端访问的时候，此时网关则对它们进行拒载</p></li>

<li><p>限流， 如果把互联网比作信息高速的话，当服务出现了临时故障，无法满足更多的请求，那么网关则对来访者进行限流</p></li>

<li><p>熔断， 当访问出现故障的时候可以立即停止响应，以免造成更大面积的损伤。</p></li>

<li><p>聚合， 将后端多个API合并成一个对外提供服务</p></li>
</ul>

<h2 id="认证">认证</h2>

<p>来者必须亮明身份，否则不提供服务</p>

<ul>
<li><p>外部用户， 谨慎又谨慎的对待一切外部来访者，万一它是个坏人</p></li>

<li><p>内部用户， 内部用户的特点，除了在内部网络访问服务之外，也需要从互联网进行访问</p></li>
</ul>

<h2 id="服务注册与发现">服务注册与发现</h2>

<p>微服务的特性就是将服务按照业务边界进行拆分，一个完整的商业会涉及到很多很多的服务，那么使用手动的方式进行管理就不现实，那么每个成熟的服务就需要自己照顾自己了。自觉到服务注册中心登记，自己叫什么名字，在什么地方，提供什么服务，现在的状态怎么样。这样其他需要的客户端服务就可以拿着号码牌自己联系了。</p>

<h2 id="服务间通讯">服务间通讯</h2>

<p>服务之间必须使用相同的协议进行通讯，通讯的策略分为实时通讯和异步通讯，实时通讯即调用立即响应，常用的方式为<code>Web Api</code>和<code>RPC</code>两种方式，其中<code>WebApi</code>更适合服务跟终端进行通讯，基础协议为<code>HTTP</code>, 数据格式使用JSON，MSGPACK，通常会根据网络条件进行选择通讯成本低的。在各内部服务间通讯，则推荐使用<code>RPC</code>协议，当前<code>gRPC</code>成为了事实标准。</p>

<h2 id="监控运维">监控运维</h2>

<p>似乎微服务就意味着服务多，那么多的服务，没准谁就会遇到个意外，那么有一个监控告警平台是必要的。少了它，等着用户来报告服务挂了，即便内部都是哥们跟你好声好气的说，但是到了客户那里就是不给你付费了。</p>

<p>监控运维包含多项内容</p>

<ul>
<li>日志，所有的行为都要留下踪迹，为了更好的发现问题的原点</li>
<li>状态监控，出现异常情况可以立即响应</li>
<li>调用链跟踪，也是为了发现问题的原点在什么地方</li>
</ul>

  </div>
</div>
<div class="container has-text-centered">
    
</div>

<div class="container has-text-centered">
  
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      (function() {
          
          
          if (window.location.hostname == "localhost")
              return;
      
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          var disqus_shortname = 'tairan';
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    <a href="http://disqus.com/" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
  
</div>
<section class="section">
  <div class="container has-text-centered">
    <p>&copy; Copyright 2019 Tairan Wang</p>
  </div>
</section>


<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-5226610-2', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>



